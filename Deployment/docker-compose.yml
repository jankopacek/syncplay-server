version: '3.3'

services:  
  syncplay-server:
    image: trilogic/syncplay-server
    networks:
      - agent-network
      - traefik-public
    deploy:
      replicas: 1
      restart_policy:
        condition: on-failure
      labels:
        - traefik.frontend.rule=Host:syncplay.${DOMAIN?Variable DOMAIN not set}
        - traefik.enable=true
        - traefik.port=8999
        - traefik.tags=traefik-public
        - traefik.docker.network=traefik-public
        # Traefik service that listens to HTTP
        # - traefik.redirectorservice.frontend.entryPoints=http
        # - traefik.redirectorservice.frontend.redirect.entryPoint=https
        # Traefik service that listens to HTTPS
        # - traefik.webservice.frontend.entryPoints=https
    ports:
      - "8999:8999"
    environment:
     - PASSWORD=supersecretpassword  

networks:
  agent-network:
    attachable: true
  traefik-public:
    external: true

# volumes:
#   portainer-data: